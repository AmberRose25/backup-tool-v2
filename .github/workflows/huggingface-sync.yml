name: Sync to Hugging Face hub
on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  sync-to-hub:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0
      
      - name: Push to hub
        env:
          HF_TOKEN: ${{ secrets.HF_TOKEN }}
        run: |
          git config --global user.email "action@github.com"
          git config --global user.name "GitHub Action"
          
          # 1. Remove the binary files that Hugging Face hates
          rm -f packages/frontend/public/assets/background.png
          rm -f packages/frontend/src/app/icon.ico
          
          # 2. Create fake empty text files in their place 
          # (This ensures the file paths still exist so the app doesn't crash)
          echo "dummy" > packages/frontend/public/assets/background.png
          echo "dummy" > packages/frontend/src/app/icon.ico
          
          # 3. Commit these changes
          git add packages/frontend/public/assets/background.png
          git add packages/frontend/src/app/icon.ico
          git commit -m "Replace binaries with dummies for HF deployment"
          
          # 4. Push to HF
          # I kept your URL from the logs:
          git push --force https://JoeUchiha:$HF_TOKEN@huggingface.co/spaces/JoeUchiha/text-processing-api-01 main
